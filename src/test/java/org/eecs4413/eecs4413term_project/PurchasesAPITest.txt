# --- CONFIGURATION ---
# Ensure this port matches your application.properties (usually 8080)
HOST="http://localhost"
PORT=8080 
BASE_URL="$HOST:$PORT/api/purchases"

# REPLACE THIS with a valid ID from your 'users' table
VALID_USER_ID="1" 

echo "--- 1. Testing Successful Purchase ---"
# Note: Card number must be 16 digits, Cvv 3 digits, Expiry MM/YY
curl -i -X POST "$BASE_URL/makePurchase" \
  -H "Content-Type: application/json" \
  -d '{
    "item": "Vintage Comic Book",
    "amount": 1,
    "price": 50.00,
    "cardNumber": "1234123412341234",
    "cardExpiry": "12/25",
    "cardCvv": "123",
    "userId": "'"$VALID_USER_ID"'"
  }'
echo -e "\n"

echo "--- 2. Testing Invalid Card (Length check) ---"
curl -i -X POST "$BASE_URL/makePurchase" \
  -H "Content-Type: application/json" \
  -d '{
    "item": "Pen",
    "amount": 1,
    "price": 1.50,
    "cardNumber": "4242", 
    "cardExpiry": "12/25",
    "cardCvv": "123",
    "userId": "'"$VALID_USER_ID"'"
  }'
echo -e "\n"

echo "--- 3. Testing Negative Price ---"
curl -i -X POST "$BASE_URL/makePurchase" \
  -H "Content-Type: application/json" \
  -d '{
    "item": "Eraser",
    "amount": 1,
    "price": -5.00,
    "cardNumber": "1234123412341234",
    "cardExpiry": "12/25",
    "cardCvv": "123",
    "userId": "'"$VALID_USER_ID"'"
  }'
echo -e "\n"

echo "--- 4. Get All Purchases ---"
curl -i -X GET "$BASE_URL/getAllPurchases" \
  -H "Accept: application/json"
echo -e "\n"

# Note: To test 'Get Specific Purchase', you need the UUID from Test #1.
# The Postman script below handles this automatically.